jQuery((function($){jQuery(".MrPlanPlugin_SimpleSearch").each((function(){let picker=null,disponibilidad=[],ElementBtn=jQuery(this).find(".MrPlanPlugin_SimpleSearchBtnEvnt"),css=ElementBtn.attr("css"),version=ElementBtn.attr("version"),link=ElementBtn.attr("link"),id_elemento=ElementBtn.attr("id_elemento"),id_punto_venta=ElementBtn.attr("id_punto_venta"),id_operador=ElementBtn.attr("id_destino"),id_idioma=ElementBtn.attr("id_idioma"),motor_id=ElementBtn.attr("motor_id"),a=null,b=null;jQuery(this).find(".MrPlanPlugin_SimpleSearchBtnEvnt").unbind("click").click((function(evnt){if(1==version){let tipo_elemento=1,start_date=picker.getStartDate(),end_date=picker.getEndDate();b=moment(start_date),a=moment(end_date);let n_noches=a.diff(b,"days"),fecha_entrada=b.format("DD/MM/Y"),fecha_salida=a.format("DD/MM/Y"),url=new URL(link);url.searchParams.append("fecha_entrada",fecha_entrada),url.searchParams.append("fecha_salida",fecha_salida),url.searchParams.append("n_noches",n_noches),url.searchParams.append("autoload",1),url.searchParams.append("id_idioma",id_idioma),url.searchParams.append("id_elemento",id_elemento),url.searchParams.append("tipo_elemento",tipo_elemento),url.searchParams.append("id_operador",id_operador),url.searchParams.append("id_punto_venta",id_punto_venta),window.location.href=url.toString()}else if(2==version){let tipo_elemento=2,start_date=picker.getDate();b=moment(start_date);let fecha_entrada=b.format("DD/MM/Y"),n_noches=1,url=new URL(link);url.searchParams.append("autoload",1),url.searchParams.append("fecha_entrada",fecha_entrada),url.searchParams.append("fecha_salida",fecha_entrada),url.searchParams.append("n_noches",n_noches),url.searchParams.append("autoload",1),url.searchParams.append("id_idioma",id_idioma),url.searchParams.append("id_elemento",id_elemento),url.searchParams.append("tipo_elemento",tipo_elemento),url.searchParams.append("id_operador",id_operador),url.searchParams.append("id_punto_venta",id_punto_venta),window.location.href=url.toString()}}));let options={element:document.getElementById("MrPlanPlugin_DateRangePicker_"+motor_id),css:["https://cdn.jsdelivr.net/npm/@easepick/bundle@1.2.1/dist/index.css",css],zIndex:10,format:"DD MMM YYYY",lang:"es-ES",AmpPlugin:{dropdown:{months:!0,years:!0,minYear:2023,maxYear:2025},darkMode:!1},LockPlugin:{minDate:new Date,inseparable:!0},date:1e3*moment().unix(),RangePlugin:{tooltipNumber:num=>num-1,locale:{one:"noche",other:"noches"},startDate:1e3*moment().add(2,"days").unix(),endDate:1e3*moment().add(4,"days").unix()},plugins:["AmpPlugin","LockPlugin"],setup(picker){console.log("setup"),picker.on("view",evt=>{const{view:view,date:date,target:target}=evt.detail,d=date?1e3*moment(date.format("YYYY-MM-DD")).unix():null;"CalendarDay"===view&&null!=disponibilidad[d]?(target.classList.add("MrPlanPlugin_Calendar_Day_"+disponibilidad[d].Type),console.log("ADD "+disponibilidad[d].Type)):console.log("NO esta "+d)})}};if(1==version&&options.plugins.push("RangePlugin"),1==version)var request=jQuery.ajax({url:"https://mrplan.io/experiencias/modulos/TExpCalendario/lib/accion.TExpCalendario.php?&id_casa="+id_elemento+"&id_elemento="+id_elemento+"&tipo=1&accion=1&ews_ruta_raiz=https://www.mrplan.es/scr/../experiencias/&id_idioma=0&id_operador="+id_operador+"&id_punto_venta="+id_punto_venta+"&source_plugin=MrPlanPlugin&jsoncallback=?",type:"GET",dataType:"jsonp",async:!1}).done((function(Data){jQuery.each(Data.resultado,(function(key,value){let fecha=1e3*moment(value.Date,"DD/MM/YYYY").unix();disponibilidad[fecha]=value})),createCalendar()}));else if(2==version)var request=jQuery.ajax({url:"https://mrplan.io/experiencias/modulos/TExpCalendario/lib/accion.TExpCalendario.php?&id_experiencia="+id_elemento+"&id_elemento="+id_elemento+'&tipo=2&accion=1&Filtros={"desdeTaquilla":0}&ews_ruta_raiz=https://www.mrplan.es/scr/../experiencias/&id_idioma=0&id_operador='+id_operador+"&id_punto_venta="+id_punto_venta+"&source_plugin=MrPlanPlugin&jsoncallback=?",type:"GET",dataType:"jsonp",async:!1}).done((function(Data){jQuery.each(Data.resultado,(function(key,value){let fecha=1e3*moment(value.Date,"DD/MM/YYYY").unix();disponibilidad[fecha]=value})),createCalendar()}));function createCalendar(){jQuery("#MrPlanPlugin_DateRangePicker_"+motor_id).attr("type","text"),picker=new easepick.create(options)}}))}));